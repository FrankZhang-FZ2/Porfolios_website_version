<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Qilin Zhang" />

<meta name="date" content="2023-04-20" />

<title>Portfolios 8</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="p01.html">Wordcloud</a>
</li>
<li>
  <a href="p02.html">Topic Modeling w/ Chinese (LDA)</a>
</li>
<li>
  <a href="p03.html">cleaning&amp;assumption check</a>
</li>
<li>
  <a href="p04.html">EFA&amp;CFA</a>
</li>
<li>
  <a href="p05.html">Multigroup model</a>
</li>
<li>
  <a href="p06.html">IRT(General Partial Credit Model)</a>
</li>
<li>
  <a href="p07.html">Web scraping</a>
</li>
<li>
  <a href="p08.html">simulation&amp;bootstraping</a>
</li>
<li>
  <a href="p09.html">Multi-level modeling</a>
</li>
<li>
  <a href="p10.html">interactive visualization</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Portfolios 8</h1>
<h4 class="author">Qilin Zhang</h4>
<h4 class="date">2023-04-20</h4>

</div>


<p>###Bootscraping and simulation</p>
<p>This is an example of using data simulation and bootstrapping to
validate the results from traditional statistical tests such as t-test
and chi-square. In this attempt, I used data from the Openintro package
called ncbirths. This data set contains the birth record data released
by NC state in 2004.</p>
<p>This exercise is derived from a exercise I did in the lab 11 of <a
href="https://datascience4psych.github.io/DataScience4Psych/lab11.html">Data
Science for Psychologists</a>.</p>
<div id="load-packages-and-data" class="section level3">
<h3>Load packages and data</h3>
<pre class="r"><code>library(ggplot2)
library(tidymodels)
library(openintro)
library(psych)
library(skimr)
library(boot)
library(tidyverse)</code></pre>
</div>
<div id="descriptive" class="section level3">
<h3>descriptive</h3>
<p>I see 13 variables in total. There are 6 numeric variables and 7
categorical variables.</p>
<pre class="r"><code>data(ncbirths)

describe(ncbirths)</code></pre>
<pre><code>##                 vars    n  mean    sd median trimmed   mad min   max range
## fage               1  829 30.26  6.76  30.00   30.01  7.41  14 55.00 41.00
## mage               2 1000 27.00  6.21  27.00   26.81  7.41  13 50.00 37.00
## mature*            3 1000  1.87  0.34   2.00    1.96  0.00   1  2.00  1.00
## weeks              4  998 38.33  2.93  39.00   38.66  1.48  20 45.00 25.00
## premie*            5  998  1.15  0.36   1.00    1.07  0.00   1  2.00  1.00
## visits             6  991 12.10  3.95  12.00   12.18  2.97   0 30.00 30.00
## marital*           7  999  1.61  0.49   2.00    1.64  0.00   1  2.00  1.00
## gained             8  973 30.33 14.24  30.00   29.78 13.34   0 85.00 85.00
## weight             9 1000  7.10  1.51   7.31    7.23  1.22   1 11.75 10.75
## lowbirthweight*   10 1000  1.89  0.31   2.00    1.99  0.00   1  2.00  1.00
## gender*           11 1000  1.50  0.50   1.00    1.50  0.00   1  2.00  1.00
## habit*            12  999  1.13  0.33   1.00    1.03  0.00   1  2.00  1.00
## whitemom*         13  998  1.72  0.45   2.00    1.77  0.00   1  2.00  1.00
##                  skew kurtosis   se
## fage             0.29    -0.25 0.23
## mage             0.26    -0.64 0.20
## mature*         -2.16     2.66 0.01
## weeks           -2.01     7.66 0.09
## premie*          1.93     1.74 0.01
## visits           0.17     2.14 0.13
## marital*        -0.47    -1.78 0.02
## gained           0.46     0.74 0.46
## weight          -1.14     2.69 0.05
## lowbirthweight* -2.47     4.12 0.01
## gender*          0.01    -2.00 0.02
## habit*           2.25     3.06 0.01
## whitemom*       -0.95    -1.09 0.01</code></pre>
<pre class="r"><code>skim(ncbirths)</code></pre>
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">ncbirths</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">1000</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">13</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">factor</td>
<td align="left">7</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<colgroup>
<col width="20%" />
<col width="13%" />
<col width="18%" />
<col width="10%" />
<col width="12%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">ordered</th>
<th align="right">n_unique</th>
<th align="left">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mature</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">you: 867, mat: 133</td>
</tr>
<tr class="even">
<td align="left">premie</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">ful: 846, pre: 152</td>
</tr>
<tr class="odd">
<td align="left">marital</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">mar: 613, not: 386</td>
</tr>
<tr class="even">
<td align="left">lowbirthweight</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">not: 889, low: 111</td>
</tr>
<tr class="odd">
<td align="left">gender</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">fem: 503, mal: 497</td>
</tr>
<tr class="even">
<td align="left">habit</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">non: 873, smo: 126</td>
</tr>
<tr class="odd">
<td align="left">whitemom</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="right">2</td>
<td align="left">whi: 714, not: 284</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col width="16%" />
<col width="12%" />
<col width="16%" />
<col width="7%" />
<col width="7%" />
<col width="3%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fage</td>
<td align="right">171</td>
<td align="right">0.83</td>
<td align="right">30.26</td>
<td align="right">6.76</td>
<td align="right">14</td>
<td align="right">25.00</td>
<td align="right">30.00</td>
<td align="right">35.00</td>
<td align="right">55.00</td>
<td align="left">▃▇▇▂▁</td>
</tr>
<tr class="even">
<td align="left">mage</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">27.00</td>
<td align="right">6.21</td>
<td align="right">13</td>
<td align="right">22.00</td>
<td align="right">27.00</td>
<td align="right">32.00</td>
<td align="right">50.00</td>
<td align="left">▃▇▇▂▁</td>
</tr>
<tr class="odd">
<td align="left">weeks</td>
<td align="right">2</td>
<td align="right">1.00</td>
<td align="right">38.33</td>
<td align="right">2.93</td>
<td align="right">20</td>
<td align="right">37.00</td>
<td align="right">39.00</td>
<td align="right">40.00</td>
<td align="right">45.00</td>
<td align="left">▁▁▁▇▂</td>
</tr>
<tr class="even">
<td align="left">visits</td>
<td align="right">9</td>
<td align="right">0.99</td>
<td align="right">12.10</td>
<td align="right">3.95</td>
<td align="right">0</td>
<td align="right">10.00</td>
<td align="right">12.00</td>
<td align="right">15.00</td>
<td align="right">30.00</td>
<td align="left">▂▇▇▁▁</td>
</tr>
<tr class="odd">
<td align="left">gained</td>
<td align="right">27</td>
<td align="right">0.97</td>
<td align="right">30.33</td>
<td align="right">14.24</td>
<td align="right">0</td>
<td align="right">20.00</td>
<td align="right">30.00</td>
<td align="right">38.00</td>
<td align="right">85.00</td>
<td align="left">▂▇▅▁▁</td>
</tr>
<tr class="even">
<td align="left">weight</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">7.10</td>
<td align="right">1.51</td>
<td align="right">1</td>
<td align="right">6.38</td>
<td align="right">7.31</td>
<td align="right">8.06</td>
<td align="right">11.75</td>
<td align="left">▁▁▇▇▁</td>
</tr>
</tbody>
</table>
<pre class="r"><code># visualization

ncbirths %&gt;%
  ggplot(aes(x=weight))+
  geom_density() #baby weight</code></pre>
<p><img src="p08_files/figure-html/check-1.png" width="672" /></p>
<pre class="r"><code>ncbirths %&gt;%
  ggplot(aes(x=gained))+
  geom_density() #weight gained by mother during pregnancy in pounds</code></pre>
<p><img src="p08_files/figure-html/check-2.png" width="672" /></p>
<pre class="r"><code>ncbirths %&gt;%
  ggplot(aes(x=visits))+
  geom_density() #number of hospital visits during pregnancy</code></pre>
<p><img src="p08_files/figure-html/check-3.png" width="672" /></p>
<pre class="r"><code>ncbirths %&gt;%
  ggplot(aes(x=weeks))+
  geom_density() #length of pregnancy in weeks</code></pre>
<p><img src="p08_files/figure-html/check-4.png" width="672" /></p>
</div>
<div id="t-test-bootstrap" class="section level3">
<h3>t-test bootstrap</h3>
<p>It seems like there is only a few means lower than 7.250462 in the
bootstrapping sample. After accounting for the proportion of the means
lower than 7.25, the p value with 15000 rep of bootstraping is 0.0005.
As a result, we can conclude that the mean of child’s weight is
significantly lower than those in 1995.</p>
<pre class="r"><code>ncbirths_white &lt;- ncbirths %&gt;%
  filter(whitemom == &quot;white&quot;)

mean(ncbirths_white$weight) # sample mean = 7.25</code></pre>
<pre><code>## [1] 7.250462</code></pre>
<pre class="r"><code>#bootstrap
set.seed(123)
boot_bir_white &lt;- ncbirths_white %&gt;%
  # specify the variable of interest
  specify(response = weight) %&gt;%
  # generate 15000 bootstrap samples
  generate(reps = 15000, type = &quot;bootstrap&quot;) %&gt;%
  # calculate the mean of each bootstrap sample 
  calculate(stat = &quot;mean&quot;)

boot_bir_white %&gt;%
  summarize(lower = quantile(stat, 0.025),
            mean = mean(stat),
            upper = quantile(stat, 0.975))</code></pre>
<pre><code>## # A tibble: 1 × 3
##   lower  mean upper
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  7.15  7.25  7.35</code></pre>
<pre class="r"><code>boot_bir_white$stat &lt;- boot_bir_white$stat - (mean(ncbirths_white$weight) - 7.43) #7.43 was the mean baby weight in 1995
mean(boot_bir_white$stat)</code></pre>
<pre><code>## [1] 7.430849</code></pre>
<pre class="r"><code>boot_bir_white %&gt;%
  summarize(lower = quantile(stat, 0.025),
            mean = mean(stat),
            upper = quantile(stat, 0.975))</code></pre>
<pre><code>## # A tibble: 1 × 3
##   lower  mean upper
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  7.33  7.43  7.53</code></pre>
<pre class="r"><code>boot_bir_white %&gt;%
  filter(stat &lt;= 7.250462) %&gt;%
  nrow()/nrow(boot_bir_white)# p value = 0.0005</code></pre>
<pre><code>## [1] 0.0004666667</code></pre>
<pre class="r"><code>#visual
boot_bir_white %&gt;%
  ggplot(aes(x=stat)) + 
  geom_histogram(binwidth = 0.001)+
  geom_vline(xintercept = 7.33)+ #lower quantile
  geom_vline(xintercept = 7.53)+ #higher quantile
  geom_vline(xintercept = 7.250462, color = &quot;red&quot;)+
  geom_text(aes(x = 7.275, y = 100, label = &quot;current mean&quot;), color = &quot;red&quot;, size = 3)+
  labs(title = &quot;distribution for bootstrap means&quot;)</code></pre>
<p><img src="p08_files/figure-html/white_baby-1.png" width="672" /></p>
<p>###t-test replication</p>
<p>Just want to confirm it with the traditional approach. Indeed, one
sample t-test suggests that the mean of child’s weight is significantly
(based on p&lt;0.05)lower than those in 1995.</p>
<pre class="r"><code>t.test(x= ncbirths_white$weight,mu = 7.43)</code></pre>
<pre><code>
    One Sample t-test

data:  ncbirths_white$weight
t = -3.3472, df = 713, p-value = 0.0008593
alternative hypothesis: true mean is not equal to 7.43
95 percent confidence interval:
 7.145153 7.355771
sample estimates:
mean of x 
 7.250462 
</code></pre>
<p>###box plot comparison</p>
<p>From the plots, it seems like the baby weight of non-smokers are
higher than smokers.</p>
<pre class="r"><code>ncbirths_habitgiven &lt;- ncbirths %&gt;%
  filter(habit != &quot;NA&quot;)

ncbirths_habitgiven %&gt;%
  ggplot(aes(x=habit, y = weight, color = habit)) + 
  geom_boxplot()</code></pre>
<p><img src="p08_files/figure-html/boxplot-1.png" width="672" /></p>
<p>###t-test bootstrap</p>
<p>Null hypothesis: There is no difference between baby weight with
smoking and non-smoking parents among the population. Alternative
hypothesis: There is difference between baby weight with smoking and
non-smoking parents among the population.</p>
<pre class="r"><code>ncbirths_habitgiven %&gt;%
  group_by(habit) %&gt;%
  summarise(mean_weight = mean(weight),
            median_weight = median(weight))</code></pre>
<pre><code>## # A tibble: 2 × 3
##   habit     mean_weight median_weight
##   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;
## 1 nonsmoker        7.14          7.31
## 2 smoker           6.83          7.06</code></pre>
<p>There is difference between baby weight with smoking and non-smoking
parents among the population. In particular, the baby weight with
smoking parents are significantly lower than those of the non-smoking
parents. The confident interval represents that we have 95% of confident
that the results t value will land between 0.45-4.16.</p>
<pre class="r"><code>Smokers &lt;- ncbirths_habitgiven %&gt;%
  filter(habit==&quot;smoker&quot;) %&gt;%
  select(weight)
Smokers$id &lt;- c(1:nrow(Smokers))

nonsmokers &lt;- ncbirths_habitgiven %&gt;%
  filter(habit==&quot;nonsmoker&quot;) %&gt;%
  select(weight)
nonsmokers$id &lt;- c(1:nrow(nonsmokers))
smoking_boot &lt;- merge(nonsmokers,Smokers,
                      by = &quot;id&quot;,
                      all = T) %&gt;%
  select(!id)

tstat &lt;- function(data, indices) {
  sampled_data &lt;- data[indices, ]
  t.test(sampled_data$weight.x, sampled_data$weight.y)$statistic
}

set.seed(1234)
boot_result &lt;- boot(smoking_boot, tstat, R=15000)

mean(boot_result$t)</code></pre>
<pre><code>## [1] 2.340838</code></pre>
<pre class="r"><code>#confident interval
quantile(boot_result$t,0.025)</code></pre>
<pre><code>##      2.5% 
## 0.4502762</code></pre>
<pre class="r"><code>quantile(boot_result$t,0.975)</code></pre>
<pre><code>##    97.5% 
## 4.163082</code></pre>
<pre class="r"><code># transfer t to p
t_to_p &lt;- function(t, df) {
  p &lt;- 2 * pt(abs(t), df = df, lower.tail = FALSE)
  return(p)
}
t_to_p(mean(boot_result$t) ,999-2)</code></pre>
<pre><code>## [1] 0.01943685</code></pre>
<pre class="r"><code>#replicate with traditional t-test
t.test(smoking_boot$weight.x,smoking_boot$weight.y)</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  smoking_boot$weight.x and smoking_boot$weight.y
t = 2.359, df = 171.32, p-value = 0.01945
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.05151165 0.57957328
sample estimates:
mean of x mean of y 
 7.144273  6.828730 
</code></pre>
<p>###visualize cutoff</p>
<p>It looks like cutoff is at 34 to 35.</p>
<pre class="r"><code>cutoff &lt;- ncbirths_habitgiven%&gt;%
  filter(mature==&quot;younger mom&quot;)%&gt;%
  select(mage)%&gt;%
  max()%&gt;%
  as.numeric()
cutoff</code></pre>
<pre><code>## [1] 34</code></pre>
<pre class="r"><code>ggplot(ncbirths_habitgiven, aes(x = mage, fill = mature))+
  geom_histogram(binwidth = 0.5)+
  geom_vline(xintercept = cutoff+0.5)</code></pre>
<p><img src="p08_files/figure-html/cutoff-1.png" width="672" /></p>
<p>###chisqure</p>
<p>Null hypothesis: the proportion of low birth weight babies is not
different among mature or non-mature mothers Alternative hypothesis: the
proportion of low birth weight babies is higher for mature mothers</p>
<p>It seems like there is no significant difference on the proportion of
low birthweight babies between mature and non-mature mothers. Therefore,
the original hypothesis in the question does not stand.</p>
<pre class="r"><code>mature_lowweight &lt;- ncbirths_habitgiven %&gt;%
  select(c(mature,lowbirthweight)) %&gt;%
  table()

mature_lowweight</code></pre>
<pre><code>##              lowbirthweight
## mature        low not low
##   mature mom   17     115
##   younger mom  93     774</code></pre>
<pre class="r"><code>#direct way
chisq.test(mature_lowweight,simulate.p.value = T,B = 10000)</code></pre>
<pre><code>
    Pearson&#39;s Chi-squared test with simulated p-value (based on 10000
    replicates)

data:  mature_lowweight
X-squared = 0.54151, df = NA, p-value = 0.5604
</code></pre>
<pre class="r"><code>chi_sq_stat &lt;- function(data, indices) {
  tbl &lt;- data[indices,]
  chisq &lt;- chisq.test(tbl)$statistic
  return(chisq)
}

boot_results &lt;- boot(data = mature_lowweight, statistic = chi_sq_stat, R = 10000)
# confident intervals
boot.ci(boot_results, type = &quot;basic&quot;,conf = 0.95)</code></pre>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot_results, conf = 0.95, type = &quot;basic&quot;)
## 
## Intervals : 
## Level      Basic         
## 95%   ( 0.3441,  0.6883 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
